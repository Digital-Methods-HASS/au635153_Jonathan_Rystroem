---
title: "CDS HomeWork 6"
author: "Jonathan Rystrøm"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: pdf_document
urlcolor: blue
---

### load packages
```{r}
pacman::p_load(gapminder, tidyverse)
```

### Loading data
```{r}
dat <- gapminder
```

## Question 1: 
*Define a defensive function that calculates the Gross Domestic Product of a nation from the data available in the gapminder dataset. Using that function, calculate the GDP of Denmark in the following years: 1967, 1977, 1987, 1997, 2007, and 2017.*

Defensive function means that we should make sure the data input is numeric
```{r}
calculate_gdp <- function(population, gdpPercapita) {
  stopifnot(is.numeric(population) & is.numeric(gdpPercapita))
  return(population * gdpPercapita)
}

dat %>% 
  filter(year %in% c(1967, 1977, 1987, 1997, 2007, 2017), country == "Denmark") %>% 
  mutate(total_gdp = calculate_gdp(pop, gdpPercap)) %>% 
  select(year, total_gdp)
  
```

## Question 2
*Write a script that loops over each country in the gapminder dataset, tests whether the country starts with a ‘B’ , and print out whether the life expectancy is smaller than 50, between 50 and 70, or greater than 70. (Hint: use the Control Flow tutorial as a guide here)*

## Question 3
*Challenge/Optional: Write a script that loops over each country in the gapminder dataset, tests whether the country starts with a ‘M’ and graphs life expectancy against time (using plot() function) as a line graph if the mean life expectancy is under 50 years.*